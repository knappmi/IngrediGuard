# Android Signing Setup for IngrediGuard

## Overview
This document describes the Android signing setup for IngrediGuard, including keystore generation and GitHub Actions configuration.

## Keystore Details
- **Keystore file**: `android/keystore/ingrediguard-release-key.jks`
- **Key alias**: `ingrediguard-release`
- **Algorithm**: RSA 2048-bit
- **Validity**: 10,000 days (until 2052)
- **Certificate subject**: CN=IngrediGuard, OU=Mobile Development, O=IngrediGuard, L=Personal, ST=Personal, C=US

## GitHub Secrets Setup

To enable secure signing in GitHub Actions, you need to set up the following secrets in your GitHub repository:

### 1. KEYSTORE_BASE64
This contains the base64-encoded keystore file. 

**To set up:**
1. Go to your GitHub repository
2. Navigate to Settings > Secrets and variables > Actions
3. Click "New repository secret"
4. Name: `KEYSTORE_BASE64`
5. Value: Copy the content from `keystore_base64.txt` (generated during setup)

### 2. KEYSTORE_PASSWORD
The keystore password.

**To set up:**
1. Create a new repository secret
2. Name: `KEYSTORE_PASSWORD`
3. Value: `IngrediGuard2025!`

### 3. KEY_ALIAS_PASSWORD
The key alias password (same as keystore password in this setup).

**To set up:**
1. Create a new repository secret
2. Name: `KEY_ALIAS_PASSWORD`
3. Value: `IngrediGuard2025!`

### 4. KEY_ALIAS
The key alias name.

**To set up:**
1. Create a new repository secret
2. Name: `KEY_ALIAS`
3. Value: `ingrediguard-release`

## Security Notes

1. **Never commit the keystore file** - It's included in `.gitignore`
2. **Keep passwords secure** - Only store them in GitHub secrets
3. **Backup your keystore** - Store it securely offline as losing it means you can't update your app
4. **Certificate fingerprints** for verification:
   - SHA1: B4:66:F7:74:C6:0F:7E:34:01:55:B6:1E:75:61:A8:F6:27:D6:DF:16
   - SHA256: C7:B7:82:9C:5E:27:6D:C2:66:EF:4C:03:B2:6E:25:5D:E3:77:1F:10:39:82:4B:4A:3B:23:DA:AB:E7:EB:F6:BF

## Build Process

### Debug Builds (APK)
- Triggered on all branches except `main`
- Uses debug signing (automatic)
- Produces unsigned APK for testing

### Release Builds (AAB)
- Triggered only on `main` branch
- Uses release signing with the keystore
- Produces signed AAB ready for Play Store upload

## Local Development

For local release builds, set these environment variables:
```bash
export KEYSTORE_PASSWORD="IngrediGuard2025!"
export KEY_ALIAS_PASSWORD="IngrediGuard2025!"
```

Then run:
```bash
buildozer android release
```

## Play Store Upload

The signed AAB file generated by GitHub Actions can be directly uploaded to the Google Play Console for app distribution.

## Troubleshooting

### Common Issues:
1. **Missing keystore**: Ensure `KEYSTORE_BASE64` secret is set correctly
2. **Wrong password**: Verify `KEYSTORE_PASSWORD` and `KEY_ALIAS_PASSWORD` secrets
3. **Build failures**: Check the build logs in GitHub Actions artifacts

### Verification Commands:
```bash
# List keystore contents
keytool -list -v -keystore android/keystore/ingrediguard-release-key.jks

# Verify AAB signature
jarsigner -verify -verbose -certs your-app.aab
```
